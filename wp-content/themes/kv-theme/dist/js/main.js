;(function () {    let offset = 10;    let limit = 10;    let html;    let n = 'messages/?message_friend=';    $(document).ready(() => {        $(window).on('load', function () {            setTimeout(function () {                $('#preloader').fadeOut('slow', function () {                });            }, 500)        });        /* ---------------------------------------------- /*         * Navbar         /* ---------------------------------------------- */        /*$('.header').sticky({         topSpacing: 0         });*/        $('body').scrollspy({            target: '.navbar-custom',            offset: 70        });        $('#myTab a').click(function (e) {            e.preventDefault();            $(this).tab('show')        });        $('.popup-gallery').magnificPopup({            delegate: 'a',            type: 'image',            tClose: 'Выйти (Esc)',            /*tLoading: 'Loading image #%curr%...',*/            mainClass: 'mfp-fade',            removalDelay: 300,            gallery: {                preloader: true,                enabled: true,                navigateByImgClick: true,                /*<i class="fa fa-arrow-circle-left" aria-hidden="true"></i>*/                tCounter: '<span class="mfp-counter" style="display: none;">%curr% of %total%</span>', // markup of counter                preload: [0, 1] // Will preload 0 - before current, and 1 after the current image            },            image: {                tError: '<a href="%url%">Изображение #%curr%</a> не загружено.',                /*titleSrc: function(item) {                 return item.el.attr('title') + '<small>by Vlad Kudinov</small>';                 }*/            }        });        let ajaxURL = "http://socspace.zzz.com.ua/wp-admin/admin-ajax.php";        /*let ajaxURL = "http://localhost:8080/KV/wp-admin/admin-ajax.php";*/        if (location.href.indexOf(n) !== -1) {            setInterval(function () {                updateMessage();            }, 10000);        }        setInterval(function () {            updateMessageCount();        }, 3000);        function updateMessageCount() {            let fd = new FormData();            fd.append('action', 'countMessages');            $.ajax({                type: 'post',                url: ajaxURL,                data: fd,                cache: false,                contentType: false,                processData: false,                success: function (answ) {                    //console.log(answ);                    if (answ['status'] === 200) {                        $('#labelMessageCount').html(answ['count']);                    }//if                    if (answ['status'] === 300) {                        $('#labelMessageCount').html(answ['count']);                    }//if                }//success            })        }//updateMessageCount        function updateMessage() {            let idRecToUpdateMes = $('#updateMessOnline').data('rec');            let fd = new FormData();            fd.append('action', 'updateMessage');            fd.append('idRecToUpdateMes', idRecToUpdateMes);            $.ajax({                type: 'post',                url: ajaxURL,                data: fd,                cache: false,                contentType: false,                processData: false,                success: function (answ) {                    /*console.log(answ);*/                    if (answ['status'] === 200) {                        /*console.log(answ['comments']);*/                        //$('#labelMessageCount').html();                        location.reload();                    }//if                    /*location.reload();*/                }//success            })        }//updateMessage        //Uplode messages with scroll        $(window).scroll(function () {            if (location.href.indexOf(n) == -1) return;            if ($(window).scrollTop() == $(document).height() - $(window).height()) {                let userLogin = $('#LoadMore').val();                let fd = new FormData();                fd.append('action', 'GetMoreMessages');                fd.append('offset', offset);                fd.append('limit', limit);                fd.append('userLogin', userLogin);                $.ajax({                    type: 'post',                    url: ajaxURL,                    data: fd,                    cache: false,                    contentType: false,                    processData: false,                    beforeSend: function () {                        $('#preloader2').show();                        /*alert("Запрос");*/                    },                    complete: function () {                        $('#preloader2').hide();                    },                    success: function (data) {                        /*console.log(data);*/                        let messageArray = JSON.parse(data);                        console.log(messageArray['result']);                        if (messageArray['result'].length == 0) {                            /*$('#preloader2').css("display","none");*/                            $('#preloader2').hide();                            /*alert("Массив dataFull пустой");*/                            $('#EndMessage').modal('show');                        }                        $.each(messageArray['result'], (index, comments) => {                            let html = `<li class="form-group bg-gray-light message-item">                             <span class="text-bold dialog_name_fz">                              ${ comments.itsMe === 'no' ? comments.comment_author : 'Вы'}                            </span>                            <div class="message-date">${comments.comment_date}</div>                            <div>                                <p class="dialog_content_pad">                                    ${comments.comment_content}                                </p>                            </div>                            <div class="message_delete" data-tooltip="Удалить"                                 data-dlt_msg_id="${comments.comment_ID}">                                <i class="fa fa-times " aria-hidden="true"></i>                            </div>                        </li>`;                            $('.messagesChat').append(html);                        });                        offset += limit;                    }//success                });            }        });        $('.registration-form input[type="text"], .registration-form input[type="email"], .registration-form input[type="password"]').on('focus', function () {            $(this).removeClass('input-error');            $('.empty_loginReg').css("visibility", "hidden");            $('.error_loginReg').css("visibility", "hidden");            $('.empty_firstNameReg').css("visibility", "hidden");            $('.empty_secondNameReg').css("visibility", "hidden");            $('.error_emailReg').css("visibility", "hidden");            $('.empty_emailReg').css("visibility", "hidden");            $('.empty_passwordReg').css("visibility", "hidden");            $('.invalid_emailReg').css("visibility", "hidden");        });        $('#registrUser').click((e) => {            let nameRegistr = $('#nameRegistr').val();            let emailRegistr = $('#emailRegistr').val();            let passRegistr = $('#passRegistr').val();            let firstnameRegistr = $('#firstnameRegistr').val();            let lastnameRegistr = $('#lastnameRegistr').val();            if (                nameRegistr == "" ||                emailRegistr == "" ||                passRegistr == "" ||                firstnameRegistr == "" ||                lastnameRegistr == ""            ) {                $('.registration-form').effect("shake", "slow");            }            if (nameRegistr == "") {                e.preventDefault();                $('.empty_loginReg').css("visibility", "visible");                $('#nameRegistr').addClass('input-error');            }            if (emailRegistr == "") {                e.preventDefault();                $('#emailRegistr').addClass('input-error');                $('.empty_emailReg').css("visibility", "visible");                $('.invalid_emailReg').css("visibility", "hidden");            }            if (passRegistr == "") {                e.preventDefault();                $('.empty_passwordReg').css("visibility", "visible");                $('#passRegistr').addClass('input-error');            }            if (firstnameRegistr == "") {                e.preventDefault();                $('.empty_firstNameReg').css("visibility", "visible");                $('#firstnameRegistr').addClass('input-error');            }            if (lastnameRegistr == "") {                e.preventDefault();                $('.empty_secondNameReg').css("visibility", "visible");                $('#lastnameRegistr').addClass('input-error');            }            else {                $('#nameRegistr').removeClass('input-error');                $('#emailRegistr').removeClass('input-error');                $('#passRegistr').removeClass('input-error');                $('#firstnameRegistr').removeClass('input-error');                $('#lastnameRegistr').removeClass('input-error');                $('.empty_loginReg').css("visibility", "hidden");                $('.empty_firstNameReg').css("visibility", "hidden");                $('.empty_secondNameReg').css("visibility", "hidden");                $('.empty_emailReg').css("visibility", "hidden");                $('.empty_passwordReg').css("visibility", "hidden");                $.post(                    ajaxURL,                    {                        'action': 'UserRegistration',                        'nameRegistr': nameRegistr,                        'emailRegistr': emailRegistr,                        'passRegistr': passRegistr,                        'firstnameRegistr': firstnameRegistr,                        'lastnameRegistr': lastnameRegistr                    },                    (response) => {                        let ResponseObject = JSON.parse(response);                        if (ResponseObject.status === 5) {                            $('#firstnameRegistr').addClass('input-error');                            $('.registration-form').effect("shake", "slow");                            setTimeout(function () {                                $('#ErrorLongNameModal').modal('show');                            }, 1500);                        }                        if (ResponseObject.status === 6) {                            $('#lastnameRegistr').addClass('input-error');                            $('.registration-form').effect("shake", "slow");                            setTimeout(function () {                                $('#ErrorLongSecondNameModal').modal('show');                            } , 1500);                        }                        if (ResponseObject.status === 200) {                            //alert(ResponseObject.message);                            $('#successRegistr').modal('show');                            setTimeout(function () {                                window.location.replace("http://socspace.zzz.com.ua/autorize");                            } , 2000);                            /*window.location.replace("http://localhost:8080/KV/autorize");*/                        }                        if (ResponseObject.status === 300) {                            /*console.log(ResponseObject.message);                             console.log(ResponseObject.code);*/                            if (ResponseObject.code == 'invalid_email') {                                $('#nameRegistr').addClass('input-error');                                $('.error_emailReg').css("visibility", "visible");                                $('.error_emailReg').css("margin-left", " -120px");                                $('.registration-form').effect("shake", "slow");                            }                            if (ResponseObject.code == 'invalid_username') {                                $('#nameAuthorize').addClass('input-error');                                $('.error_loginReg').css("visibility", "visible");                                $('.error_loginReg').css("margin-left", " -120px");                                $('.registration-form').effect("shake", "slow");                            }                            if (ResponseObject.code == 'incorrect_password') {                                $('#passRegistr').addClass('input-error');                                $('.empty_passwordReg').css("visibility", "visible");                                $('.registration-form').effect("shake", "slow");                            }                        }                        if (ResponseObject.status === 500) {                            if (ResponseObject.user_login == 1) {                                $('#nameRegistr').addClass('input-error');                                $('.error_loginReg').css("visibility", "visible");                                $('.error_loginReg').css("margin-left", " -120px");                                $('.registration-form').effect("shake", "slow");                            } else {                                $('#nameRegistr').removeClass('input-error');                                $('.error_loginReg').css("visibility", "hidden");                            }                            if (ResponseObject.user_email == 1) {                                $('#emailRegistr').addClass('input-error');                                $('.error_emailReg').css("visibility", "visible");                                $('.error_emailReg').css("margin-left", " -120px");                                $('.registration-form').effect("shake", "slow");                            }                            else {                                $('#emailRegistr').removeClass('input-error');                                $('.error_emailReg').css("visibility", "hidden");                            }                            /*alert(ResponseObject.message);*/                        }                        if (ResponseObject.status === 600) {                            $('#passRegistr').addClass('input-error');                            $('.empty_passwordReg').css("visibility", "visible");                            $('.registration-form').effect("shake", "slow");                            /*alert(ResponseObject.message);*/                            /*alert(ResponseObject.message);*/                        }                        if (ResponseObject.status === 700) {                            $('.empty_loginReg').css("visibility", "visible");                            $('#nameRegistr').addClass('input-error');                            $('.registration-form').effect("shake", "slow");                        }                        if (ResponseObject.status === 800) {                            $('#emailRegistr').addClass('input-error');                            $('.empty_emailReg').css("visibility", "visible");                            $('.registration-form').effect("shake", "slow");                        }                        if (ResponseObject.status === 100) {                            $('#emailRegistr').addClass('input-error');                            $('.invalid_emailReg').css("margin-left", " -240px");                            $('.invalid_emailReg').css("visibility", "visible");                            $('.registration-form').effect("shake", "slow");                            console.log(ResponseObject.message);                        }                    }                )//post            }        });        $('.authorize-form input[type="text"]').on('focus', function () {            $(this).removeClass('input-error');            /*$('.empty_emailAuth').css("visibility", "hidden");            $('.empty_loginAuth').css("visibility", "hidden");*/            $('.empty_emailAuth').css("display", "none");            $('.empty_loginAuth').css("display", "none");            $('.empty_loginInput').css("display", "none");        });        $('.authorize-form input[type="password"]').on('focus', function () {            $(this).removeClass('input-error');            $('.empty_passInput').css("display", "none");            $('.empty_passAuth').css("display", "none");        });        $('#autorizeUser').click((e) => {            let nameAuthorize = $('#nameAuthorize').val();            let passAuthorize = $('#passAuthorize').val();            if (nameAuthorize == "" || passAuthorize == "") {                e.preventDefault();                $('.authorize-form').effect("shake", "slow");            }            if (nameAuthorize == "" ) {                $('.empty_loginInput').css("display", "inline");                $('#nameAuthorize').addClass('input-error');            }            if (passAuthorize == "") {                e.preventDefault();                $('.empty_passInput').css("display", "inline");                $('#passAuthorize').addClass('input-error');            }            else {                $('#nameAuthorize').removeClass('input-error');                $('#passAuthorize').removeClass('input-error');                $.post(                    ajaxURL,                    {                        'action': 'UserAuthorize',                        'nameAuthorize': nameAuthorize,                        'passAuthorize': passAuthorize                    },                    (response) => {                        let ResponseObject = JSON.parse(response);                        if (ResponseObject.status === 200) {                            /*alert(ResponseObject.message);*/                            window.location.replace("http://socspace.zzz.com.ua/profile");                            /*window.location.replace("http://localhost:8080/KV/profile");*/                        }                        if (ResponseObject.status === 300) {                            /*console.log(ResponseObject.message);                             console.log(ResponseObject.code);*/                            /*invalid_username*/                            /*incorrect_password                             * invalid_email*/                            if (ResponseObject.code == 'invalid_email') {                                $('#nameAuthorize').addClass('input-error');                                /*$('.empty_emailAuth').css("visibility", "visible");                                $('.empty_emailAuth').css("margin-left", " -120px");*/                                $('.empty_emailAuth').css("display", "inline");                                $('.authorize-form').effect("shake", "slow");                                /*effect( "bounce", "slow" );*/                            }                            if (ResponseObject.code == 'invalid_username') {                                $('#nameAuthorize').addClass('input-error');                                /*$('.empty_loginAuth').css("visibility", "visible");*/                                $('.empty_loginAuth').css("display", "inline");                                $('.authorize-form').effect("shake", "slow");                            }                            if (ResponseObject.code == 'incorrect_password') {                                $('#passAuthorize').addClass('input-error');                                /*$('.empty_passAuth').css("visibility", "visible");*/                                $('.empty_passAuth').css("display", "inline");                                $('.authorize-form').effect("shake", "slow");                            }                        }                        if (ResponseObject.status === 401) {                            //alert(ResponseObject.message);                            $('.empty_loginInput').css("display", "inline");                            $('#nameAuthorize').addClass('input-error');                        }                        if (ResponseObject.status === 402) {                            //alert(ResponseObject.message);                            $('.empty_passInput').css("display", "inline");                            $('#nameAuthorize').addClass('input-error');                        }                    }                )//post            }//else        });        $('#deleteProfileButton').click((e) => {            $("#deleteUserAction").modal('show');            /*delete_userProfile*/            $('#delete_userProfile').click((e) => {                e.preventDefault();                let fd = new FormData();                fd.append('action', 'DeleteUserProfile');                $.ajax({                    type: 'post',                    url: ajaxURL,                    data: fd,                    cache: false,                    contentType: false,                    processData: false,                    success: function (answ) {                        console.log(answ);                        if (answ['status'] === 200) {                            location.reload();                        }                        if (answ['status'] === 300) {                            alert("Пользователя нельзя удалить");                        }                    }                })                /*$.post(                 ajaxURL,                 {                 'action': 'DeleteUserProfile',                 },                 (response) => {                 let ResponseObject = JSON.parse(response);                 console.log(ResponseObject.message);                 if (ResponseObject.status === 200) {                 /!*alert(ResponseObject.message);*!/                 /!*window.location.replace("http://localhost/KV/profile");*!/                 window.location.replace("http://localhost:8080/KV/");                 }                 });*/            });        });        let locationuserEdit = 'edit_profile';        if (location.href.indexOf(locationuserEdit) !== -1) {            var day = new Date,                md = (new Date(day.getFullYear(), day.getMonth() + 1, 0, 0, 0, 0, 0)).getDate(),                $month_name = "января февраля марта апреля мая июня июля августа сентября октября ноября декабря".split(" ");            function set_select(a, c, d, e) {                var el = document.getElementsByName(a)[0];                for (var b = el.options.length = 0; b < c; b++) {                    el.options[b] = new Option(a == 'month' ? $month_name[b] : b + d, b + d);                }                el.options[e] && (el.options[e].selected = !0)            }            set_select("day", md, 1, day.getDate() - 17);            set_select("month", 12, 1, day.getMonth() - 12);            set_select("year", 100, day.getFullYear() - 90, 90);            document.getElementsByName('hour')[0].value = day.getHours();            document.getElementsByName('minute')[0].value = day.getMinutes();            var year = document.getElementById('year');            var month = document.getElementById("month");            function check_date() {                var a = year.value | 0,                    c = month.value | 0;                md = (new Date(a, c, 0, 0, 0, 0, 0)).getDate();                a = document.getElementById("day").selectedIndex;                set_select("day", md, 1, a)            };            if (document.addEventListener) {                year.addEventListener('change', check_date, false);                month.addEventListener('change', check_date, false);            } else {                year.detachEvent('onchange', check_date);                month.detachEvent('onchange', check_date);            }        }        $('#edit-profile').click(() => {            let user_edit_name = $("#user_edit_name").val();            let user_edit_secondName = $("#user_edit_secondName").val();            let edit_textAbout = $("#edit_textAbout").val();            let day = $("#day").val();            let month = $("#month").val();            let year = $("#year").val();            let country = $("#country").val();            let city = $("#city").val();            let fd_userEdit = new FormData();            fd_userEdit.append('action', 'UserEditProfile');            fd_userEdit.append('user_edit_name', user_edit_name);            fd_userEdit.append('user_edit_secondName', user_edit_secondName);            fd_userEdit.append('edit_textAbout', edit_textAbout);            fd_userEdit.append('day', day);            fd_userEdit.append('month', month);            fd_userEdit.append('year', year);            fd_userEdit.append('country', country);            fd_userEdit.append('city', city);            $.ajax({                    type: 'post',                    url: ajaxURL,                    data: fd_userEdit,                    cache: false,                    contentType: false,                    processData: false,                    success: function (answ) {                        console.log(answ);                        /* alert(answ.message);*/                        $('#successEditUserData').modal('show');                        setTimeout(function () {                            location.reload()                        }, 2000);                    }//succes                }            )        });        $('.clear_avatar').click((e) => {            e.preventDefault();            $('#edit_image_profile').val('');        });        function readImage(input) {            if (input.files && input.files[0]) {                let reader = new FileReader();                reader.onload = function (e) {                    $('#editUserAvatar').modal('show');                    let progressbar = $("#progressbar-5");                    let progressLabel = $(".progress-label");                    $("#progressbar-5").progressbar({                        value: 1,                        change: function () {                            progressLabel.text(                                progressbar.progressbar("value") + "%");                            $('.img_preview').css("visibility", "hidden");                            $('.ui-widget-header').removeClass('ui-widget-header1');                            $('.progress-label').removeClass('progress-label1');                            $('#edit_avatar').addClass('disabled');                        },                        complete: function () {                            progressLabel.text("Загрузка окончена");                            $('.img_preview').css("visibility", "visible");                            $('.ui-widget-header').addClass('ui-widget-header1');                            $('.progress-label').addClass('progress-label1');                            $('#edit_avatar').removeClass('disabled');                        }                    });                    function progress() {                        let val = progressbar.progressbar("value") || 0;                        progressbar.progressbar("value", val + 3);                        if (val < 99) {                            setTimeout(progress, 30);                        }                    }                    setTimeout(progress, 1000);                    $('#preview').attr('src', e.target.result);                };                reader.readAsDataURL(input.files[0]);            }        }        function printMessage(destination, msg) {            $(destination).removeClass();            if (msg == 'success') {                $(destination).addClass('alert alert-success').text('Файл успешно загружен.');            }            if (msg == 'error') {                $(destination).addClass('alert alert-danger').text('Произошла ошибка при загрузке файла.');            }        }        $('#edit_image_profile').change(function () {            readImage(this);        });        $('#edit_avatar').click(() => {            let PostID = $('#edit_avatar').data('avaidpost');            let user_avatar = $('#edit_image_profile').prop('files')[0];            let fd = new FormData();            fd.append('action', 'EditAvatar');            fd.append('photo', user_avatar);            fd.append('PostID', PostID);            $.ajax({                type: 'post',                url: ajaxURL,                data: fd,                cache: false,                contentType: false,                processData: false,                success: function (data) {                    console.log(data);                    if (data['status'] === 501) {                        console.log(data['message']);                        $('#editUserAvatar').modal('hide');                        $('#edit_image_profile').val('');                        $('#ErrorBigAvtr').modal('show');                    }                    if(data['status'] === 204){                        $('#editUserAvatar').modal('hide');                        $('#edit_image_profile').val('');                        $('#ErrorAvtrFormat').modal('show');                    } else {                       if(data['status'] === 200){                            printMessage('#result', data.message);                            setTimeout(function () {                                location.reload();                            }, 2000);                        }                    }                },                error: function (data) {                    /*console.log(data);*/                }            })        });        $('.searchFriend').on('focus', function () {            $(this).removeClass('input-error');            $('.empty_dataSearch').css("visibility", "hidden");        });        $('#search_friend').click((e) => {            let searchFriend = $('#searchFriend').val();            if (searchFriend == "") {                e.preventDefault();                $('.searchFriend').addClass('input-error');                $('.empty_dataSearch').css("visibility", "visible");            }            else {                $('.searchFriend').removeClass('input-error');                let fd = new FormData();                fd.append('action', 'SearchUser');                fd.append('searchFriend', searchFriend);                $.ajax({                    type: 'post',                    url: ajaxURL,                    data: fd,                    cache: false,                    contentType: false,                    processData: false,                    success: function (answ) {                        console.log(answ);                        window.location.replace("http://socspace.zzz.com.ua/all_friends/?search=" + answ['search']);                        /*window.location.replace("http://localhost:8080/KV/all_friends/?search=" + answ['search']);*/                        /*window.location.replace("http://localhost/KV/edit_profile");*/                        /*window.location.replace("http://localhost:8080/KV/edit_profile");*/                    }//success                })            }        });        $("body").on('click', '.dialog_delete', function () {            let mf = $(this).data('delete_dialog');            /*console.log(mf);*/            $('#myModal').modal('show');            $("body").on('click', '.delete_test', function () {                alert(mf);                location.reload();            });        });        $("body").on('click', '.messageWall_delete', function () {            let mf = $(this).data('dlt_msgwall');            //console.log(mf);            $('#delFromWallModal').modal('show');            $("body").on('click', '.del_msg_from_wall', function () {                let fd = new FormData();                fd.append('action', 'DeleteMsgFromWall');                fd.append('deleteMsgWall', mf);                //alert(mf);                //location.reload();                $.ajax({                    type: 'post',                    url: ajaxURL,                    data: fd,                    cache: false,                    contentType: false,                    processData: false,                    success: function (answ) {                        console.log(answ);                        /*window.location.replace("http://localhost/KV/messages/?message_friend=" + answ['friend']);*/                        if (answ['status'] === 200) {                            console.log("Сообщение с ID: " + answ['delMessage'] + " " + answ['message']);                            $('#DeleteMsgFromWall').modal('hide');                            /*alert("Сообщение с ID: " + answ['delMessage'] + " " + answ['message']);*/                            location.reload();                        }                        if (answ['status'] === 500) {                            console.log("Сообщение не удалено" + answ['message']);                        }                    }//success                })            });        });        $("body").on('click', '.message_delete', function () {            let mf = $(this).data('dlt_msg_id');            $('#delFromChatModal').modal('show');            $("body").on('click', '.del_msg_from_chat', function () {                let fd = new FormData();                fd.append('action', 'DeleteMsgFromChat');                fd.append('deleteMsgWall', mf);                $.ajax({                    type: 'post',                    url: ajaxURL,                    data: fd,                    cache: false,                    contentType: false,                    processData: false,                    success: function (answ) {                        console.log(answ);                        /*window.location.replace("http://localhost/KV/messages/?message_friend=" + answ['friend']);*/                        if (answ['status'] === 200) {                            console.log("Сообщение с ID: " + answ['delMessage'] + " " + answ['message']);                            $('#delFromChatModal').modal('hide');                            /*alert("Сообщение с ID: " + answ['delMessage'] + " " + answ['message']);*/                            location.reload();                        }                        if (answ['status'] === 500) {                            console.log("Сообщение не удалено" + answ['message']);                        }                    }//success                })            });        });        $("body").on('click', '.dialogs_friend_read', function (event) {            event.preventDefault();            let messageFriend = $(this).data('message-friend');            let fd = new FormData();            fd.append('action', 'GoToFriendMessage');            fd.append('messageFriend', messageFriend);            $.ajax({                type: 'post',                url: ajaxURL,                data: fd,                cache: false,                contentType: false,                processData: false,                success: function (answ) {                    /*console.log(answ['friend']);*/                    window.location.replace("http://socspace.zzz.com.ua/messages/?message_friend=" + answ['friend']);                    /*window.location.replace("http://localhost:8080/KV/messages/?message_friend=" + answ['friend']);*/                }//success            })        });        $('.inputMessage').on('focus', function () {            $(this).removeClass('input-error');            $('.empty_message').css("opacity", "0");            $('#messageWallSubmit').fadeIn(400);        });        $('.inputMessage').focusout( function () {            $('#messageWallSubmit').fadeOut(400);        });        $("body").on('click', '#messageWallSubmit', function () {            let wallMessage = $('#wallMessage').val();            if (wallMessage == "") {                $('#wallMessage').addClass('input-error');                $('.empty_message').css("opacity", "1");                $('#messageWallSubmit').fadeOut(400);            }            else {                $('#wallMessage').removeClass('input-error');                $('.empty_message').css("opacity", "0");                let inputRecipientWall = $(this).data('recipientwall');                let fd = new FormData();                fd.append('action', 'AddMessageWall');                fd.append('wallMessage', wallMessage);                fd.append('inputRecipientWall', inputRecipientWall);                $.ajax({                    type: 'post',                    url: ajaxURL,                    data: fd,                    cache: false,                    contentType: false,                    processData: false,                    success: function (answ) {                        console.log(answ);                        $('#messageWallSubmit').fadeOut(400);                        $('#wallMessage').val("");                        location.reload();                        /*window.location.replace("http://localhost/KV/all_friends/?search="+answ['search']);*/                        //location.reload();                    }//success                })            }        });//messageWallSubmit        $("body").on('click', '#messageSubmit', function () {            let inputMessage = $('#inputMessage').val();            if (inputMessage == "") {                $('#inputMessage').addClass('input-error');                $('.empty_message').css("opacity", "1");            }            else {                $('#inputMessage').removeClass('input-error');                $('.empty_message').css("opacity", "0");                let inputRecipient = $(this).data('recipient');                let fd = new FormData();                fd.append('action', 'AddMessage');                fd.append('inputMessage', inputMessage);                fd.append('inputRecipient', inputRecipient);                $.ajax({                    type: 'post',                    url: ajaxURL,                    data: fd,                    cache: false,                    contentType: false,                    processData: false,                    success: function (answ) {                        console.log(answ);                        $('#inputMessage').val("");                        /*window.location.replace("http://localhost/KV/all_friends/?search="+answ['search']);*/                        location.reload();                    }//success                })            }        });//messageSubmit        //ConfirmFriend        $("body").on('click', '.addToFriends', function () {            let addUserToFriend = $(this).data('add-to-friend');            let fd = new FormData();            fd.append('action', 'ConfirmFriend');            fd.append('addUserToFriend', addUserToFriend);            $.ajax({                type: 'post',                url: ajaxURL,                data: fd,                cache: false,                contentType: false,                processData: false,                success: function (answ) {                    /*console.log(answ);                    console.log(answ['array']);*/                    $('#statusWindowMembers').html("Добавление в друзья");                    $('.statusUser').html("Вы добавили в друзья " + answ['friend_firstName'] + " " + answ['friend_lastName']);                    $('#confirmFriendModal').modal('show');                    setTimeout(function () {                        location.reload();                    } , 3000);                }//success            })        });//ConfirmFriend        $("body").on('click', '.deleteFromFriends', function () {            let deleteUserFromFriend = $(this).data('delete-from-friend');            let fd = new FormData();            fd.append('action', 'DeleteFromUser');            fd.append('deleteUserFromFriend', deleteUserFromFriend);            $.ajax({                type: 'post',                url: ajaxURL,                data: fd,                cache: false,                contentType: false,                processData: false,                success: function (answ) {                    console.log(answ);                    console.log(answ['deleteFriend']);                    $('#statusWindowMembers').html("Удаление из друзей");                    $('.statusUser').html("Вы удаляете из друзей " + answ['deleteFriend_firstName'] + " " + answ['deleteFriend_secondName']);                    $('#confirmFriendModal').modal('show');                    /*alert("Вы удалили из друзей пользователя " + answ['deleteFriend']);*/                    setTimeout(function () {                        location.reload();                    } , 3000);                    /*window.location.replace("http://localhost/KV/all_friends");*/                    /*window.location.replace("http://localhost:8080/KV/all_friends");*/                }//success            })        });//deleteFromFriends        $("body").on('click', '.addToFollowing', function () {            let AddUserToFollowing = $(this).data('add-to-following');            let fd = new FormData();            fd.append('action', 'AddToFollowing');            fd.append('AddUserToFollowing', AddUserToFollowing);            $.ajax({                type: 'post',                url: ajaxURL,                data: fd,                cache: false,                contentType: false,                processData: false,                success: function (answ) {                    /*console.log(answ);                     console.log(answ['following']);                     alert("Вы подписались на пользователя " + answ['following']);                     location.reload();*/                    $('#statusWindowMembers').html("Подписаться на пользователя");                    $('.statusUser').html("Вы подписались на " + answ['following_firstName'] + " " + answ['following_lastName']);                    $('#confirmFriendModal').modal('show');                    /*alert("Вы удалили из друзей пользователя " + answ['deleteFriend']);*/                    setTimeout(function () {                        location.reload();                    } , 3000);                    /*window.location.replace("http://localhost/KV/all_friends");*/                    /*window.location.replace("http://localhost:8080/KV/all_friends");*/                }//success            })        });//addToFollowing        $("body").on('click', '.refuseUserFollowing', function () {            let RefuseFollowing = $(this).data('refuse-following');            let fd = new FormData();            fd.append('action', 'RefuseUserFollowing');            fd.append('RefuseFollowing', RefuseFollowing);            $.ajax({                type: 'post',                url: ajaxURL,                data: fd,                cache: false,                contentType: false,                processData: false,                success: function (answ) {                    /*console.log(answ);                    console.log(answ['following']);                    alert("Вы отписались от пользователя " + answ['following']);*/                    $('#statusWindowMembers').html("Отписаться от пользователя");                    $('.statusUser').html("Вы отписались от " + answ['followingRef_firstName'] + " " + answ['followingRef_lastName']);                    $('#confirmFriendModal').modal('show');                    setTimeout(function () {                        location.reload();                    } , 3000);                }//success            })        });//refuseUserFollowing        $.FileDialog = function FileDialog(userOptions) {            var options = $.extend($.FileDialog.defaults, userOptions),                modal = $([                    "<div class='modal fade'>",                    "    <div class='modal-dialog'>",                    "        <div class='modal-content'>",                    "            <div class='modal-header'>",                    "                <button type='button' class='close' data-dismiss='modal'>",                    "                    <span aria-hidden='true'>x</span>",                    "                    <span class='sr-only'>",                    options.cancel_button,                    "                    </span>",                    "                </button>",                    "                <h4 class='modal-title'>",                    options.title,                    "                </h4>",                    "            </div>",                    "            <div class='modal-body'>",                    "                <input type='file' style='display: none;'/>",                    "                <div class='bfd-dropfield'>",                    "                    <div class='bfd-dropfield-inner'>",                    options.drag_message,                    "                    </div>",                    "                </div>",                    "                <div class='container-fluid bfd-files'>",                    "                </div>",                    "            </div>",                    "            <div class='modal-footer'>",                    "                <button type='button' class='btn btn-primary bfd-ok'>",                    options.ok_button,                    "                </button>",                    "                <button type='button' class='btn btn-default bfd-cancel'",                    "                                data-dismiss='modal'>",                    options.cancel_button,                    "                </button>",                    "            </div>",                    "        </div>",                    "    </div>",                    "</div>"                ].join("")),                done = false,                input = $("input:file", modal),                dropfield = $(".bfd-dropfield", modal),                dropfieldInner = $(".bfd-dropfield-inner", dropfield);            dropfieldInner.css({                "height": options.dropheight,                "padding-top": options.dropheight / 2 - 32            });            input.attr({                "accept": options.accept,                "multiple": options.multiple            });            dropfield.on("click.bfd", function () {                input.trigger("click");            });            var loadedFiles = [],                readers = [];            var loadFile = function (f) {                var reader = new FileReader(),                    progressBar,                    row;                readers.push(reader);                reader.onloadstart = function () {                };                reader.onerror = function (e) {                    if (e.target.error.code === e.target.error.ABORT_ERR) {                        return;                    }                    progressBar.parent().html([                        "<div class='bg-danger bfd-error-message'>",                        options.error_message,                        "</div>"                    ].join("\n"));                };                reader.onprogress = function (e) {                    var percentLoaded = Math.round(e.loaded * 100 / e.total) + "%";                    progressBar.attr("aria-valuenow", e.loaded);                    progressBar.css("width", percentLoaded);                    $(".sr-only", progressBar).text(percentLoaded);                };                reader.onload = function (e) {                    f.content = e.target.result;                    loadedFiles.push(f);                    progressBar.removeClass("active");                };                var progress = $([                    "<div class='col-xs-7 col-sm-4 bfd-info'>",                    "    <span class='bfd-remove'><i class='fa fa-times' aria-hidden='true'></i></span>&nbsp;",                    "    <span class=''><i class='fa fa-file-image-o' aria-hidden='true'></i></span>&nbsp;" + f.name,                    "</div>",                    "<div class='col-xs-5 col-sm-8 bfd-progress'>",                    "    <div class='progress'>",                    "        <div class='progress-bar progress-bar-striped active' role='progressbar'",                    "            aria-valuenow='0' aria-valuemin='0' aria-valuemax='" + f.size + "'>",                    "            <span class='sr-only'>0%</span>",                    "        </div>",                    "    </div>",                    "</div>"                ].join(""));                progressBar = $(".progress-bar", progress);                $(".bfd-remove", progress).tooltip({                    "container": "body",                    "html": true,                    "placement": "top",                    "title": options.remove_message                }).on("click.bfd", function () {                    var idx = loadedFiles.indexOf(f);                    if (idx >= 0) {                        loadedFiles.pop(idx);                    }                    row.fadeOut();                    try {                        reader.abort();                    } catch (e) {                    }                });                row = $("<div class='row'></div>");                row.append(progress);                $(".bfd-files", modal).append(row);                reader["readAs" + options.readAs](f);            };            var loadFiles = function loadFiles(flist) {                Array.prototype.forEach.apply(flist, [loadFile]);            };            // setting up event handlers            input.change(function (e) {                e = e.originalEvent;                var files = e.target.files;                loadFiles(files);                // clearing input field by replacing it with a clone (lol)                var newInput = input.clone(true);                input.replaceWith(newInput);                input = newInput;            });            // // drag&drop stuff            dropfield.on("dragenter.bfd", function () {                dropfieldInner.addClass("bfd-dragover");            }).on("dragover.bfd", function (e) {                e = e.originalEvent;                e.stopPropagation();                e.preventDefault();                e.dataTransfer.dropEffect = "copy";            }).on("dragleave.bfd drop.bfd", function () {                dropfieldInner.removeClass("bfd-dragover");            }).on("drop.bfd", function (e) {                e = e.originalEvent;                e.stopPropagation();                e.preventDefault();                var files = e.dataTransfer.files;                if (files.length === 0) {                    // problem with desktop/browser                    // ... TODO                }                loadFiles(files);            });            $(".bfd-ok", modal).on("click.bfd", function () {                var event = $.Event("files.bs.filedialog");                event.files = loadedFiles;                modal.trigger(event);                done = true;                modal.modal("hide");            });            modal.on("hidden.bs.modal", function () {                readers.forEach(function (reader) {                    try {                        reader.abort();                    } catch (e) {                    }                });                if (!done) {                    var event = $.Event("cancel.bs.filedialog");                    modal.trigger(event);                }                modal.remove();            });            $(document.body).append(modal);            modal.modal();            return modal;        };        $.FileDialog.defaults = {            "accept": "*", /* e.g. 'image/*' */            "cancel_button": "Отмена",            "drag_message": "Загружай фото сюда",            "dropheight": 200,            "error_message": "Ошибка загрузки фото",            "multiple": true,            "ok_button": "Загрузить",            "readAs": "DataURL", /* possible choices: BinaryString, Text, DataURL, ArrayBuffer, */            "remove_message": "Удалить&nbsp;фото",            "title": "Загрузка фото"        };        $('body').on('files.bs.filedialog', function (ev) {            var files_list = ev.files;            console.log(files_list);            let photoID = $('#open_btn').data('postid');            console.log(photoID);            let fd = new FormData();            fd.append('action', 'AddFotoToProfile');            fd.append('photoID', photoID);            $.each(files_list, function (i, file) {                fd.append('file' + i, file);            });            $.ajax({                type: 'post',                url: ajaxURL,                data: fd,                cache: false,                contentType: false,                processData: false,                /*beforeSend: function(){                    $('#preloader2').show();                },*/                success: function (answ) {                    console.log(answ);                    if(answ['status'] == 101){                        $('#emptyAddFoto').modal('show');                    } else {                        if(answ['status'] == 100 ){                            $('#errorAddFoto').modal('show');                        } else{                            $('#successAddFoto').modal('show');                            setTimeout(function () {                                location.reload();                            }, 3000);                        }                    }                },                error: function (answ) {                    console.log(answ);                }//success            })            // DO SOMETHING        });        $("#open_btn").click(function () {            $.FileDialog({});        });        //$('.foto_delete').tooltip();        $("body").on("click", '.foto_delete', function () {            $('#delFotoModal').modal('show');            let btnDelFoto = $(this).data('id');            console.log(btnDelFoto);            $(".del_foto_from_gallery").one('click', function () {                let fd = new FormData();                fd.append('action', 'DeleteFotoFromGallery');                fd.append('btnDelFoto', btnDelFoto);                $.ajax({                    type: 'post',                    url: ajaxURL,                    data: fd,                    cache: false,                    contentType: false,                    processData: false,                    success: function (answ) {                        //console.log(answ);                        location.reload();                    }//success                })            });        });    });})();